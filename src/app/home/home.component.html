<app-label-page
  label="Team Manager"
  description="Explain what user can do in this page"
></app-label-page>
<div class="d-flex align-items-start justify-content-between">
  <div *ngFor="let state of status">
    <app-column label="{{ state.label }}">
      <div *ngFor="let task of tasks | filterByStatus: state.value">
        <app-card [task]="task"></app-card>
      </div>
    </app-column>
  </div>
  <app-column [dark]="true">
    <div *ngFor="let milestone of milestones">
      <app-card [isMilestone]="true" [milestone]="milestone"> </app-card>
    </div>
  </app-column>
</div>
<app-actions
  icon="pi-plus"
  [large]="true"
  [position]="true"
  (onClick)="applyEvent($event)"
></app-actions>
<app-modal [open]="open" (close)="changeStatusModal(false)">
  <div class="p-5" *ngIf="currentEvent === 'pi-trash'">
    <div class="d-flex justify-content-center pb-5">
      <span class="font-size-14">
        Are you sure that want to delete this task?</span
      >
    </div>
    <div class="d-flex justify-content-center">
      <div class="pr-2">
        <app-button
          label="Cancel"
          [secondary]="true"
          (onClick)="changeStatusModal(false)"
        ></app-button>
      </div>
      <app-button label="Delete"></app-button>
    </div>
  </div>
  <div class="p-5" *ngIf="currentEvent === 'pi-play'">
    <div class="pb-5">
      <app-dropdown
        label="User"
        [options]="getUserOptions()"
        [value]="inputStartTask"
      ></app-dropdown>
    </div>
    <div class="d-flex justify-content-center">
      <div class="pr-2">
        <app-button
          label="Cancel"
          [secondary]="true"
          (onClick)="changeStatusModal(false)"
        ></app-button>
      </div>
      <app-button label="Assign"></app-button>
    </div>
  </div>
  <div class="p-5" *ngIf="currentEvent === 'pi-user'">
    <div class="pb-5">
      <app-dropdown
        label="User"
        [options]="getUserOptions()"
        [(value)]="inputReassignTask"
      ></app-dropdown>
    </div>
    <div class="d-flex justify-content-center">
      <div class="pr-2">
        <app-button
          label="Cancel"
          [secondary]="true"
          (onClick)="changeStatusModal(false)"
        ></app-button>
      </div>
      <app-button label="Assign"></app-button>
    </div>
  </div>
  <div class="p-5" *ngIf="currentEvent === 'pi-pencil'">
    <div class="pb-5">
      <div class="pt-2 pb-2">
        <app-input
          type="text"
          label="Task"
          [(value)]="inputDescription"
        ></app-input>
      </div>
      <div class="pt-2 pb-2">
        <app-input
          type="date"
          label="Deadline"
          [(value)]="inputDeadline"
        ></app-input>
      </div>
      <div class="pt-2 pb-2">
        <app-dropdown
          label="Milestone"
          [options]="getMilestoneOptions()"
          [(value)]="inputMilestoneSelectedValue"
        ></app-dropdown>
      </div>
      <div class="font-bold font-size-14 pt-2">Label</div>
      <div class="pt-2">
        <app-label
          label="{{ getMilestone(inputMilestoneSelectedValue)?.label }}"
          backgroundColor="{{ getRgb(inputMilestoneSelectedValue) }}"
        ></app-label>
      </div>
    </div>
    <div class="d-flex justify-content-center">
      <div class="pr-2">
        <app-button
          label="Cancel"
          [secondary]="true"
          (onClick)="changeStatusModal(false)"
        ></app-button>
      </div>
      <app-button label="Submit"></app-button>
    </div>
  </div>
  <div class="p-5" *ngIf="currentEvent === 'pi-plus'">
    <div class="pb-5">
      <app-input
        type="text"
        label="Task"
        [(value)]="inputDescription"
      ></app-input>
      <app-input
        type="date"
        label="Deadline"
        [(value)]="inputDeadline"
      ></app-input>
      <app-dropdown
        label="Milestone"
        [options]="getMilestoneOptions()"
        [(value)]="inputMilestoneSelectedValue"
      ></app-dropdown>
      <div *ngIf="inputMilestoneSelectedValue">
        <div class="font-bold font-size-14">Label</div>
        <div class="pt-2">
          <app-label
            label="{{ getMilestone(inputMilestoneSelectedValue)?.label }}"
            backgroundColor="{{ getRgb(inputMilestoneSelectedValue) }}"
          ></app-label>
        </div>
      </div>
    </div>
    <div class="d-flex justify-content-center">
      <div class="pr-2">
        <app-button
          label="Cancel"
          [secondary]="true"
          (onClick)="changeStatusModal(false)"
        ></app-button>
      </div>
      <app-button label="Submit" (onClick)="createTask()"></app-button>
    </div>
  </div>
  <div class="p-5" *ngIf="currentEvent === 'pi-more'">
    <div class="container">
      <div class="pb-4">
        <app-label
          label="{{ currentMilestone.label }}"
          backgroundColor="{{ getRgb(currentMilestone.color) }}"
        ></app-label>
      </div>

      <div class="pb-4">
        <div class="font-bold font-size-18">{{ currentMilestone.title }}</div>
        <div class="pt-1">
          <div class="font-size-14">
            {{ getDate(currentMilestone.deadlineDate) }}
          </div>
          <div class="font-size-14">{{ currentMilestone.deadlineHour }}</div>
        </div>
      </div>

      <div class="font-bold font-size-14 pt-3 pb-3">Descrição</div>
      <div class="font-size-14">{{ currentMilestone.description }}</div>
      <div class="font-bold font-size-14 pt-3 pb-3">Artefactos</div>
      <ul>
        <li
          *ngFor="let artifact of currentMilestone.artifacts"
          class="font-size-14 pt-1"
        >
          {{ getArtifact(artifact) }}
        </li>
      </ul>
      <div class="d-flex justify-content-start align-items-center pt-3 pb-3">
        <div class="font-bold font-size-14 pr-3">Peso</div>
        <div class="font-size-14">{{ currentMilestone.weight + " %" }}</div>
      </div>
      <div class="d-flex justify-content-start align-items-center pb-3">
        <div class="font-bold font-size-14 pr-3">Limite de Submissões</div>
        <div class="font-size-14">{{ currentMilestone.limit }}</div>
      </div>
      <div class="pt-5">
        <app-alerts
          type="info"
          message="{{
            getLeftDays(currentMilestone.deadlineDate)
          }} days left to deliver"
        ></app-alerts>
      </div>
    </div>
  </div>
</app-modal>
